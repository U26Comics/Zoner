<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Design Your Own Lifecounter</title>
<style>
/* ────────────────────────────────────────────────
   MATRIX / TRON THEME — Sixtyfour Font + Neon Lines
   ──────────────────────────────────────────────── */
@import url('https://fonts.googleapis.com/css2?family=Sixtyfour&display=swap');

:root {
  --bg: #000000;
  --card: #000000;
  --muted: #000000;
  --text: #04BD00;
  --sub: #228B22;
  --accent: #04BD00;
  --accent-2: #00FF00;
}

#matrixCanvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
  background: #000;
}

.wrapper, .toast {
  position: relative;
  z-index: 2; /* UI and SVG stay above the rain */
}

/* ────────────────────────────────────────────────
   Base
   ──────────────────────────────────────────────── */
html, body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--text);
  font-family: 'Sixtyfour', monospace;
  height: 100%;
  text-shadow: 0 0 4px #04BD00, 0 0 8px #04BD00;
}

body {
  background-color: #000;
  color: #04BD00;
}

/* ────────────────────────────────────────────────
   SVG styling — Tron line width + neon glow
   ──────────────────────────────────────────────── */
#svg1 path,
#svgHost svg path {
  fill: none;
  stroke: #04BD00;
  stroke-width: 2.5px;
  stroke-linejoin: round;
  stroke-linecap: round;
  filter: drop-shadow(0 0 6px #04BD00);
}

#svg1 rect,
#svg1 circle,
#svg1 polygon,
#svgHost svg rect,
#svgHost svg circle,
#svgHost svg polygon {
  stroke: #04BD00;
  stroke-width: 2.5px;
  fill: none;
  filter: drop-shadow(0 0 6px #04BD00);
}

/* Optional: make certain shapes glow even more */
#svgHost svg g {
  filter: drop-shadow(0 0 10px #00FF00);
}

/* ────────────────────────────────────────────────
   Layout + UI
   ──────────────────────────────────────────────── */
.wrapper {
  max-width: 1200px;
  margin: 18px auto;
  height: 600px;
  box-sizing: border-box;
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: 12px;
  padding: 12px;

}

.header { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
.title { font-weight: 700; font-size: 16px; letter-spacing: .2px; }
.badge {
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  font-weight: 700;
}

.content {
  display: flex;
  flex-direction: column;
  gap: 14px;
}
@media(max-width:920px){ .content{grid-template-columns:1fr;} }

.card {
  background: linear-gradient(180deg, rgba(0, 0, 0, 0.02), rgba(255,255,255,.01));
  border: 1px solid rgba(0, 255, 0, 0.2);
  border-radius: 12px;
  padding: 12px;
  box-shadow: 0 0 24px rgba(4,189,0,0.2);
  min-height: 0;
}

.preview {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 18px;
  overflow: visible;
}

#svgHost, #svgHost svg {
  width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
  max-width: 760px;
}
#svgHost svg {
  background: #000000;
  border-radius: 12px;
}

.controls {
  display: flex;
  gap: 8px;
  margin-top: 12px;
  flex-wrap: wrap;
  justify-content: center;
}

.row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
@media(max-width:720px){ .row{grid-template-columns:1fr;} }

.group { display: grid; gap: 10px; }

.picker {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  border-radius: 10px;
  background: var(--card);
  border: 1px solid var(--accent);
  box-shadow: 0 0 8px rgba(4,189,0,0.4);
}

.picker input[type="color"] {
  width: 40px;
  height: 40px;
  border: 2px solid #04BD00;
  border-radius: 8px;
  padding: 0;
  background: transparent;
  cursor: pointer;
  box-shadow: 0 0 6px #04BD00;
}

.picker label {
  font-size: 13px;
  color: var(--accent-2);
  min-width: 56px;
}
.picker .hex {
  font-family: 'Sixtyfour', monospace;
  color: #04BD00;
  font-size: 12px;
}

.small { font-size: 12px; color: var(--sub); line-height: 1.3; }

.btns { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
button {
  background: #000000;
  color: var(--text);
  border: 1px solid #04BD00;
  box-shadow: 0 0 8px #04BD00;
  font-family: 'Sixtyfour', monospace;
}
button.primary {
  background: linear-gradient(135deg, #04BD00, #00FF00);
  color: #000000;
  border: none;
  box-shadow: 0 0 10px #00FF00;
}
button:hover { filter: brightness(1.2); }

.output {
  background: var(--card);
  border: 1px solid var(--accent);
  border-radius: 12px;
  padding: 10px;
  font-family: 'Sixtyfour', monospace;
  font-size: 12px;
  white-space: pre-wrap;
  color: #04BD00;
  max-height: 160px;
  overflow: auto;
  text-shadow: 0 0 4px #04BD00;
}

.footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  font-size: 12px;
  color: var(--sub);
}

.toast {
  position: fixed;
  bottom: 14px;
  right: 14px;
  background: #1c693f;
  color: #ecfff4;
  padding: 10px 12px;
  border-radius: 10px;
  box-shadow: 0 0 20px #04BD00;
  opacity: 0;
  transform: translateY(8px);
  transition: all 220ms ease;
  pointer-events: none;
  z-index: 9999;
}
.toast.show { opacity: 1; transform: translateY(0); }

.copyTiny {
  background: transparent;
  border: 1px solid rgba(255,255,255,.06);
  padding: 6px;
  border-radius: 8px;
  color: var(--sub);
  cursor: pointer;
}

.svg-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
}
/* ───────────── Remove SVG glow ───────────── */
#svg1,
#svg1 *,
#svgHost svg,
#svgHost svg * {
  filter: none !important;  /* remove drop-shadow glow */
  text-shadow: none !important; /* remove text glow if any */
}

</style>
</head>
<body>
 <canvas id="matrixCanvas" aria-hidden="true"></canvas>
  <div class="wrapper">
    <div class="header">
      <div class="title">Design Your Own Lifecounter<span class="badge"> | Color Zoner</span></div>
    </div>

    <div class="content">
      <!-- PREVIEW -->
      <div class="card preview" id="previewCard">
        <div id="svgHost">
          <!-- SVG INLINE HERE -->
           <div class="svg-container"></div>
<svg id="svg1"
    width="100%"
  height="auto"
viewBox="65 125 90 35"
preserveAspectRatio="xMidYMid meet"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   inkscape:version="1.4.2 (f4327f4, 2025-05-13)"
   sodipodi:docname="Life Counter.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#505050"
     bordercolor="#eeeeee"
     borderopacity="1"
     inkscape:showpageshadow="0"
     inkscape:pageopacity="0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#505050"
     inkscape:document-units="mm"
     inkscape:zoom="2"
     inkscape:cx="388"
     inkscape:cy="567.75"
     inkscape:window-width="1920"
     inkscape:window-height="1017"
     inkscape:window-x="-8"
     inkscape:window-y="-8"
     inkscape:window-maximized="1"
     inkscape:current-layer="layer1" />
  <defs id="defs1">
    <inkscape:path-effect effect="spiro" id="path-effect12" is_visible="true" lpeversion="1" />
    <inkscape:path-effect effect="spiro" id="path-effect11" is_visible="true" lpeversion="1" />
    <marker id="DistanceX" orient="auto" refX="0.0" refY="0.0" style="overflow:visible">
      <path d="M 3,-3 L -3,3 M 0,-5 L  0,5" style="stroke:#000000; stroke-width:0.5" id="path1" />
    </marker>
    <pattern id="Hatch" patternUnits="userSpaceOnUse" width="8" height="8" x="0" y="0">
      <path d="M8 4 l-4,4" stroke="#000000" stroke-width="0.25" linecap="square" id="path2" />
      <path d="M6 2 l-4,4" stroke="#000000" stroke-width="0.25" linecap="square" id="path3" />
      <path d="M4 0 l-4,4" stroke="#000000" stroke-width="0.25" linecap="square" id="path4" />
    </pattern>
    <symbol id="*Model_Space" />
    <symbol id="*Paper_Space" />
    <symbol id="*Paper_Space0" />
  </defs>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1">
    <rect width="100%" height="100%" fill="none" />
    <use x="0" y="0" xlink:href="#g10" id="use11" transform="rotate(180,98.975731,141.43683)" />
    <g id="g10">
      <path id="path224" style="fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-width:0.165;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
        d="m 65.958379,126.50639 0.40005,-0.21166 0.40005,0.21166 0.100012,0.10584 0.100013,-0.10584 2.500048,-1.07685 v -0.13229 h 3.99997 v 0.13229 l 2.499784,1.07685 0.100012,0.10584 0.100013,-0.10584 0.40005,-0.21166 0.40005,0.21166 v 29.86088 l -0.40005,0.21166 -0.40005,-0.21166 -0.100013,-0.10584 -0.100012,0.10584 -2.499784,1.07685 v 0.13229 h -3.99997 v -0.13229 l -2.500048,-1.07685 -0.100013,-0.10584 -0.100012,0.10584 -0.40005,0.21166 -0.40005,-0.21166 z" />
      <path id="path134" style="fill:#ff00ff;fill-opacity:1;stroke:#000000;stroke-width:0.165;stroke-linecap:round;stroke-opacity:1;stroke-dasharray:none"
        d="m 69.458552,143.02962 1.599935,1.90765 h 0.799835 l 2.900098,-3.10092 v -0.79904 l -2.900098,-3.10092 h -0.799835 l -1.599935,1.90765 z" />
      <g id="g7" transform="matrix(0.26458333,0,0,0.26458333,126.48843,-155.56325)">
        <path id="path174" style="fill:#00ffff;fill-opacity:1;stroke:#020202;stroke-linecap:round;stroke-opacity:1;stroke-width:0.62362206;stroke-dasharray:none"
          d="m -190.98,1066.09 -9.448,-4.07 v 45.06 l 9.448,-2 z m -34.015,0 v 38.99 l 9.449,2 v -45.06 z m 0,112.86 9.449,4.07 v -45.06 l -9.449,2 z m 34.015,0 v -38.99 l -9.448,-2 v 45.06 z" />
      </g>
    </g>
    <text xml:space="preserve" style="font-weight:900;font-size:5.64444px;font-family:Arial;-inkscape-font-specification:'Arial, Heavy';text-align:center;letter-spacing:0.489479px;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#000000;stroke-width:0.264583;stroke-linejoin:round;paint-order:markers fill stroke"
      x="79.53405" y="141.02946" id="text1">
      <tspan id="tspan1" x="79.53405" y="141.02946" style="stroke-width:0.264583"></tspan>
    </text>
    <g id="g14">
      <g id="g11" style="stroke:#000000;stroke-opacity:1">
        <g id="g12">
          <g id="g9-5" transform="matrix(0.26458333,0,0,0.26458333,115.47859,-155.56325)" style="stroke:#000000;stroke-opacity:1">
            <path id="path221-1" style="fill:#00ffff;fill-opacity:1;stroke:#000000;stroke-width:0.245669;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
              d="m -145.606,1066.19 11.357,-3.19 h 18.898 l 11.357,3.19 v 112.66 l -11.357,3.19 h -18.898 l -11.357,-3.19 z" />
            <path d="m -144.83099,1065.98 0.755,-0.22 v 113.52 l -0.755,-0.22 z m 39.307,113.3 v -113.52 l 0.755,0.22 v 113.08 z"
              style="fill:#ff00ff;fill-opacity:1;stroke:#000000;stroke-width:0.245669;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1" id="path1-8-7" />
          </g>
          <path id="path237" style="fill:none;stroke:#000000;stroke-width:0.264583;stroke-linecap:round;stroke-opacity:1"
            d="m 77.358588,129.26468 2.600007,-0.56886 m 0,0 h 4.99999 m 0,0 2.600007,0.56886 m -10.200004,7.80785 2.600007,-0.18785 m 0,0 h 4.99999 m 0,0 2.600007,0.18785 m -2.600007,9.54352 2.600007,-0.26458 m -7.599997,0.26458 h 4.99999 m -7.599997,-0.26458 2.600007,0.26458 m -2.600007,6.94532 2.600007,0.61647 m 0,0 h 4.99999 m 0,0 2.600007,-0.61647" />
        </g>
        <path id="path11" style="fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-width:0.065;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke"
          d="M 84.958636,157.18515 V 125.68883" inkscape:path-effect="#path-effect11" inkscape:original-d="m 84.958636,157.18515 c 0,-10.49899 0,-20.99765 0,-31.49632" />
        <path id="path12" style="fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-width:0.0649999;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke"
          d="m 79.958543,125.68883 v 31.496" inkscape:path-effect="#path-effect12" inkscape:original-d="m 79.958543,125.68883 0,31.496" />
      </g>
      <use x="0" y="0" xlink:href="#g11" id="use12" transform="translate(11.009842)" />
      <use x="0" y="0" xlink:href="#g11" id="use13" transform="translate(22.019684)" />
      <use x="0" y="0" xlink:href="#g11" id="use14" transform="translate(33.029526)" />
    </g>
    <g id="g6" transform="matrix(0.26458333,0,0,0.26458333,126.48843,-156.2886)" style="stroke-width:0.62362206;stroke-dasharray:none;fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-opacity:1">
      <text xml:space="preserve" style="font-weight:900;font-size:26.9956px;font-family:Arial;-inkscape-font-specification:'Arial, Heavy';text-align:center;letter-spacing:2.34103px;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#ffff00;stroke-width:0.62362206;stroke-linejoin:round;paint-order:markers fill stroke;stroke-dasharray:none;fill-opacity:1;stroke:#000000;stroke-opacity:1"
        x="-166.39748" y="1135.0883" id="text3"><tspan id="tspan3" x="-165.22696" y="1135.0883" style="stroke-width:0.62362206;stroke-dasharray:none;fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-opacity:1">1</tspan></text>
      <text xml:space="preserve" style="font-weight:900;font-size:26.9956px;font-family:Arial;-inkscape-font-specification:'Arial, Heavy';text-align:center;letter-spacing:2.34103px;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#ffff00;stroke-width:0.62362206;stroke-linejoin:round;paint-order:markers fill stroke;stroke-dasharray:none;fill-opacity:1;stroke:#000000;stroke-opacity:1"
        x="-125.00156" y="1135.0883" id="text4"><tspan id="tspan4" x="-123.83104" y="1135.0883" style="stroke-width:0.62362206;stroke-dasharray:none;fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-opacity:1">2</tspan></text>
      <text xml:space="preserve" style="font-weight:900;font-size:26.5504px;font-family:Arial;-inkscape-font-specification:'Arial, Heavy';text-align:center;letter-spacing:2.30242px;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#ffff00;stroke-width:0.62362206;stroke-linejoin:round;paint-order:markers fill stroke;stroke-dasharray:none;fill-opacity:1;stroke:#000000;stroke-opacity:1"
        x="-82.253403" y="1134.7642" id="text5"><tspan id="tspan5" x="-81.102196" y="1134.7642" style="stroke-width:0.62362206;stroke-dasharray:none;fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-opacity:1">3</tspan></text>
      <text xml:space="preserve" style="font-weight:900;font-size:26.9956px;font-family:Arial;-inkscape-font-specification:'Arial, Heavy';text-align:center;letter-spacing:2.34103px;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#ffff00;stroke-width:0.62362206;stroke-linejoin:round;paint-order:markers fill stroke;stroke-dasharray:none;fill-opacity:1;stroke:#000000;stroke-opacity:1"
        x="-40.412746" y="1135.0883" id="text6"><tspan id="tspan6" x="-39.242233" y="1135.0883" style="stroke-width:0.62362206;stroke-dasharray:none;fill:#ffff00;fill-opacity:1;stroke:#000000;stroke-opacity:1">4</tspan></text>
    </g>
  </g>
</svg>
</div>

        <div class="card group">
          <div class="btns" style="align-items:center;">
            <div style="flex:1"></div>
<div class="controls" id="pickersRow"></div>
            <button class="primary" id="copyBtn">Copy Color Codes</button>
          </div>

          <div class="output" id="outputBox" style="margin-top:12px;"></div>
        </div>
      </div>
    </div> <!-- end .content -->

    <div class="footer small">
      <div>©Siluma v1.0</div>
    </div>
  </div> <!-- end .wrapper -->

  <div class="toast" id="toast">Copied to clipboard</div>

  <script>
  /* ---------- Utility Functions ---------- */
  function hexToRgb(hex){
    if(!hex) return null;
    hex = String(hex).trim().replace('#','');
    if(hex.length === 3) hex = hex.split('').map(c=>c+c).join('');
    if(hex.length !== 6) return null;
    const num = parseInt(hex,16);
    return { r:(num>>16)&255, g:(num>>8)&255, b:num&255 };
  }

  function parseColorToRgb(str){
    if(!str) return null;
    str = String(str).trim();
    if(str === 'none') return null;
    if(str.startsWith('#')) return hexToRgb(str);

    // rgb / rgba
    const m = str.match(/rgba?\(([^)]+)\)/i);
    if(m){
      const parts = m[1].split(',').map(s=>parseFloat(s.trim()));
      if(parts.length >= 3) return { r: parts[0], g: parts[1], b: parts[2] };
    }

    // fallback: canvas resolve (named colors)
    try {
      const ctx = document.createElement('canvas').getContext('2d');
      ctx.fillStyle = str;
      const resolved = ctx.fillStyle;
      if(typeof resolved === 'string' && resolved.startsWith('#')) return hexToRgb(resolved);
    } catch(e){}

    return null;
  }

  function rgbToHex(r,g,b){
    const toHex = v => Math.round(v).toString(16).padStart(2,'0');
    return '#' + toHex(r) + toHex(g) + toHex(b);
  }

  function isNearBlack(rgb){
    return rgb && rgb.r < 15 && rgb.g < 15 && rgb.b < 15;
  }

  function rgbToCmyk(r,g,b){
    const rr=r/255, gg=g/255, bb=b/255;
    const k = 1 - Math.max(rr, gg, bb);
    if(k >= 1-1e-8) return { c:0, m:0, y:0, k:100 };
    const c = (1 - rr - k) / (1 - k);
    const m = (1 - gg - k) / (1 - k);
    const y = (1 - bb - k) / (1 - k);
    return {
      c: Math.round(c * 100),
      m: Math.round(m * 100),
      y: Math.round(y * 100),
      k: Math.round(k * 100)
    };
  }

  /* ---------- App State ---------- */
  const state = { zones: [] }; // { id, hex, els, pickerEl, copyBtnEl }

  /* ---------- Detect up to 4 unique fill colours (ignoring near-black) ---------- */
  function detectZones(){
    const host = document.getElementById('svgHost');
    if(!host) return;
    const svg = host.querySelector('svg');
    if(!svg) return;

    const map = new Map();

    // iterate all shapes and capture fill attribute or computed fill
    svg.querySelectorAll('*').forEach(el=>{
      // ignore defs, metadata, namedview, etc.
      if(el.tagName && ['defs','metadata','sodipodi:namedview','sodipodi:namedview','style','script'].includes(el.tagName.toLowerCase())) return;

      // prefer attribute 'fill' if present
      let fill = el.getAttribute && el.getAttribute('fill');
      // fallback to computed style
      if(!fill || fill === 'none'){
        try {
          const cs = window.getComputedStyle(el);
          fill = cs && cs.fill;
        } catch(e) { /* ignore */ }
      }
      if(!fill || fill === 'none') return;

      const rgb = parseColorToRgb(fill);
      if(!rgb) return;
      if(isNearBlack(rgb)) return;

      const key = rgbToHex(Math.round(rgb.r), Math.round(rgb.g), Math.round(rgb.b));
      if(!map.has(key)) map.set(key, []);
      map.get(key).push(el);
    });

    // build up to 4 zone objects
    const entries = Array.from(map.entries()).slice(0,4);
    state.zones = entries.map(([hex, els], idx) => ({
      id: idx+1,
      hex: hex,
      els: els,
      pickerEl: null,
      copyBtnEl: null
    }));
  }

  /* ---------- Build per-zone pickers UI ---------- */
  function buildPickers(){
    const row = document.getElementById('pickersRow');
    row.innerHTML = '';
    if(!state.zones.length){
      // show a friendly empty state
      const emptyCard = document.createElement('div');
      emptyCard.className = 'picker';
      emptyCard.style.justifyContent = 'center';
      emptyCard.innerHTML = '<div class="small" style="color:var(--sub)">No non-black fills detected.</div>';
      row.appendChild(emptyCard);
      return;
    }

    state.zones.forEach(z=>{
      const wrap = document.createElement('div');
      wrap.className = 'picker';

      const input = document.createElement('input');
      input.type = 'color';
      input.value = z.hex;
      input.title = 'Zone ' + z.id + ' color';

      const label = document.createElement('label');
      label.textContent = 'Zone ' + z.id;

      const hexSpan = document.createElement('div');
      hexSpan.className = 'hex';
      hexSpan.textContent = z.hex;

      const copyTiny = document.createElement('button');
      copyTiny.className = 'copyTiny';
      copyTiny.title = 'Copy this hex';
      copyTiny.textContent = 'Copy';

      // layout: label, input, hex, copy
      wrap.appendChild(label);
      wrap.appendChild(input);
      wrap.appendChild(hexSpan);
      wrap.appendChild(copyTiny);
      row.appendChild(wrap);

      // wire events
      input.addEventListener('input', ()=>{
        z.hex = input.value;
        hexSpan.textContent = z.hex;
        z.els.forEach(el => {
  el.setAttribute('fill', z.hex);
  if(el.style) el.style.fill = z.hex;
});
        renderOutput();
      });

      copyTiny.addEventListener('click', ()=>{
        navigator.clipboard && navigator.clipboard.writeText(z.hex).then(()=> showToast('Hex copied: ' + z.hex));
      });

      z.pickerEl = input;
      z.copyBtnEl = copyTiny;
    });

    // fill placeholders if fewer than 4 zones so layout doesn't collapse
    const placeholders = Math.max(0, 4 - state.zones.length);
    for(let i=0;i<placeholders;i++){
      const ghost = document.createElement('div');
      ghost.className = 'picker';
      ghost.style.opacity = '0.45';
      ghost.style.justifyContent = 'center';
      ghost.innerHTML = '<div class="small" style="color:var(--sub)">Unused</div>';
      row.appendChild(ghost);
    }
  }

  /* ---------- Render CMYK output (one line per zone) ---------- */
  function renderOutput(){
  const out = document.getElementById('outputBox');
  if(!out) return;

  const lines = state.zones.map(z=>{
    return `Zone ${z.id}: ${z.hex.toUpperCase()}`;
  });

  out.textContent = lines.join('\n');
}

  /* ---------- Apply global color to zone index ---------- */
  function applyColour(zoneIndex, hex){
    if(!state.zones[zoneIndex]) return;
    const z = state.zones[zoneIndex];
    z.hex = hex;
    z.els.forEach(el => el.setAttribute('fill', hex));
    if(z.pickerEl) z.pickerEl.value = hex;
    renderOutput();
  }

  /* ---------- Clipboard + toast ---------- */
  function copyToClipboard(){
    const txt = document.getElementById('outputBox').textContent || '';
    if(!navigator.clipboard){ showToast('Clipboard not available'); return; }
    navigator.clipboard.writeText(txt).then(()=> showToast('Copied CMYK to clipboard'));
  }

  function showToast(msg){
    const t = document.getElementById('toast');
    if(!t) return;
    t.textContent = msg;
    t.classList.add('show');
    clearTimeout(t._hideTimer);
    t._hideTimer = setTimeout(()=> t.classList.remove('show'), 1600);
  }

  /* ---------- Init ---------- */
  function init(){
    detectZones();
    buildPickers();
    renderOutput();

    // copy button copies CMYK block
    const copyBtn = document.getElementById('copyBtn');
    if(copyBtn) copyBtn.addEventListener('click', copyToClipboard);

  }

  window.addEventListener('DOMContentLoaded', init);
  </script>
<script>
(function () {
  const canvas = document.getElementById('matrixCanvas');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');

  const glyphs = '01ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  const fontSize = 14;
  let columns, drops;

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    columns = Math.floor(canvas.width / fontSize);
    drops = new Array(columns).fill(0);
  }

  function step() {
    ctx.fillStyle = 'rgba(0,0,0,0.08)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.font = `${fontSize}px monospace`;
    ctx.fillStyle = '#04BD00';
    for (let i = 0; i < columns; i++) {
      const char = glyphs.charAt(Math.floor(Math.random() * glyphs.length));
      ctx.fillText(char, i * fontSize, drops[i] * fontSize);
      if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
      drops[i]++;
    }
    requestAnimationFrame(step);
  }

  window.addEventListener('resize', resize);
  resize();
  requestAnimationFrame(step);
})();
</script>
</body>
</html>
